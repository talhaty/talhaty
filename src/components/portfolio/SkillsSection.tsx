import { cn } from "@/lib/utils";
import {
  SiTypescript,
  SiNextdotjs,
  SiHtml5,
  SiCss3,
  SiJavascript,
  SiReact,
  SiThreedotjs,
  SiNodedotjs,
  SiExpress,
  SiC,
  SiCplusplus,
  SiPython,
  SiMongodb,
  SiMysql,
  SiGit,
  SiGithub,
  SiVite,
  SiPostman,
  SiAmazon,
  SiGooglecloud,
  SiFlask,
  SiFastapi,
  SiElectron, 
  SiOpencv,
  SiKeras,
  SiPytorch,
  SiTensorflow,
  SiGraphql,
  SiTerraform,
  SiDocker,
  SiHuggingface,
  SiLangchain
} from "react-icons/si";
import { TbBrandVercel } from "react-icons/tb";
import { Reveal, FadeInStagger, FadeInItem } from "@/components/animations/Reveal";
import { useTheme } from "@/contexts/ThemeContext";
import DotGrid from "@/components/animations/DotGrid";

const BRAND_COLORS: Record<string, string> = {
  HTML: "#E34F26",
  CSS: "#1572B6",
  JavaScript: "#F7DF1E",
  TypeScript: "#3178C6",
  "React.js": "#61DAFB",
  "Next.js": "#FFFFFF",
  "Three.js": "#FFFFFF",
  "Node.js": "#68A063",
  "Express.js": "#FFFFFF",
  "FastAPI": "#009688",
  Flask: "#000000",
  "Electron.js": "#47848F",
  TensorFlow: "#FF6F00",
  PyTorch: "#EE4C2C",
  Keras: "#D00000",
  OpenCV: "#5C3EE8",
  "Hugging Face": "#FF9900",
  Docker: "#0db7ed",
  Terraform: "#623ce4",
  GraphQL: "#E535AB",
  AWS: "#FF9900",
  "Google Cloud Platform": "#4285F4",
  LangChain: "#1A73E8",
  Java: "#F89820",
  C: "#A8B9CC",
  "C++": "#00599C",
  Python: "#3776AB",
  MongoDB: "#47A248",
  MySQL: "#4479A1",
  Git: "#F05032",
  GitHub: "#FFFFFF",
  Vite: "#646CFF",
  Postman: "#FF6C37",
  Vercel: "#FFFFFF",
};

function alpha(hex: string, a: number) {
  const h = hex.replace("#", "");
  const isShort = h.length === 3;
  const r = parseInt(isShort ? h[0] + h[0] : h.substring(0, 2), 16);
  const g = parseInt(isShort ? h[1] + h[1] : h.substring(2, 4), 16);
  const b = parseInt(isShort ? h[2] + h[2] : h.substring(4, 6), 16);
  return `rgba(${r}, ${g}, ${b}, ${a})`;
}

const skills = [
  { name: "HTML", icon: SiHtml5 },
  { name: "CSS", icon: SiCss3 },
  { name: "JavaScript", icon: SiJavascript },
  { name: "TypeScript", icon: SiTypescript },
  { name: "React.js", icon: SiReact },
  { name: "Next.js", icon: SiNextdotjs },
  { name: "Three.js", icon: SiThreedotjs },
  { name: "Node.js", icon: SiNodedotjs },
  { name: "Express.js", icon: SiExpress },
  { name: "C", icon: SiC },
  { name: "C++", icon: SiCplusplus },
  { name: "Python", icon: SiPython },
  { name: "FastAPI", icon: SiFastapi },
  { name: "Flask", icon: SiFlask },
  { name: "Electron.js", icon: SiElectron },
  { name: "TensorFlow", icon: SiTensorflow },
  { name: "PyTorch", icon: SiPytorch },
  { name: "Keras", icon: SiKeras },
  { name: "OpenCV", icon: SiOpencv },
  { name: "Hugging Face", icon: SiHuggingface },
  { name: "LangChain", icon: SiLangchain },
  { name: "AWS", icon: SiAmazon },
  { name: "GCP", icon: SiGooglecloud },
  { name: "Docker", icon: SiDocker },
  { name: "Terraform", icon: SiTerraform },
  { name: "GraphQL", icon: SiGraphql },
  { name: "MongoDB", icon: SiMongodb },
  { name: "MySQL", icon: SiMysql },
  { name: "Git", icon: SiGit },
  { name: "GitHub", icon: SiGithub },
  { name: "Vite", icon: SiVite },
  { name: "Postman", icon: SiPostman },
  { name: "Vercel", icon: TbBrandVercel },
];

const SkillsSection = () => {
  const { theme } = useTheme();

  return (
    <section id="skills" className="py-16 px-4 relative">
      <div className="container mx-auto max-w-6xl">
        <Reveal>
          <h2 className="section-title text-center">My Skills</h2>
        </Reveal>

        <Reveal>
          <p className="text-center text-foreground/70 max-w-2xl mx-auto mt-2">
            A collection of technologies and tools I'm proficient in, constantly learning and improving.
          </p>
        </Reveal>

        <Reveal>
          <div
            className="skills-shell mt-16 p-8 relative min-h-[600px] overflow-hidden bg-background
              border border-white/10"
          >
            <div className="absolute inset-0 bg-background backdrop-blur-[1px] z-0" />

            <div className="absolute inset-0 pointer-events-none z-[1] opacity-[0.15]">
              <DotGrid
                className="w-full h-full p-0"
                dotSize={4.5}
                gap={16}
                baseColor={theme === "light" ? "#f9330c" : "#40e0ff"}
                activeColor={theme === "light" ? "#f411de" : "#00ffff"}
                proximity={120}
                shockRadius={250}
                shockStrength={5}
                resistance={750}
                returnDuration={1.5}
              />
            </div>

            <div className="relative z-[2]">
              <FadeInStagger className="flex flex-wrap justify-center gap-5 gap-y-8 gap-x-6">
                {skills.map((skill) => {
                  const IconComponent = skill.icon;
                  const color = BRAND_COLORS[skill.name] || "currentColor";
                  const isWhiteBrand = color === "#FFFFFF";
                  const iconColor = isWhiteBrand ? (theme === "light" ? "#1e293b" : "#e2e8f0") : color;

                  return (
                    <FadeInItem
                      key={skill.name}
                      className={cn(
                        "relative p-4 text-center group transform transition-all duration-300 hover:-translate-y-1",
                        "bg-white/5 backdrop-blur-sm border border-white/8 hover:border-primary/50 rounded-lg"
                      )}
                    >
                      <div className="relative mb-2">
                        <div
                          className={cn(
                            "w-12 h-12 mx-auto rounded-lg flex items-center justify-center mb-2 transition-all",
                            isWhiteBrand && "icon-dark-bg"
                          )}
                          style={{
                            background: !isWhiteBrand
                              ? `linear-gradient(135deg, ${alpha(color, 0.22)}, ${alpha("#000000", 0)})`
                              : undefined,
                            boxShadow: !isWhiteBrand ? `0 0 0 1px ${alpha(color, 0.45)}` : undefined,
                          }}
                        >
                          <IconComponent className="w-6 h-6" style={{ color: iconColor }} />
                        </div>

                        <span
                          className="pointer-events-none absolute inset-0 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity"
                          style={{
                            background: `radial-gradient(120px 60px at 20% 0%, ${alpha(color, 0.18)}, transparent 60%)`,
                          }}
                        />
                      </div>

                      <span className="text-sm font-medium text-foreground/80 group-hover:text-primary transition-colors">
                        {skill.name}
                      </span>
                    </FadeInItem>
                  );
                })}
              </FadeInStagger>
            </div>
          </div>
        </Reveal>
      </div>
    </section>
  );
};

export default SkillsSection;
